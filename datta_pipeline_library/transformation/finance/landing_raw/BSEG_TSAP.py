  
#BSEG_TSAP Transform Load Landing to Raw



import logging

from pyspark.sql import SparkSession
from pyspark.sql.utils import AnalysisException
spark = SparkSession.getActiveSession()
spark.conf.set("spark.sql.parquet.enableVectorizedReader","false")

from pyspark.sql.types import StringType, StructType, StructField, IntegerType, DecimalType, DoubleType, BinaryType
from datta_pipeline_library.core.landing_raw import landing_raw,landing_raw_batch,landing_raw_aecorsoft
from datta_pipeline_library.core.transform_basic import transform_yrmono 

def load_BSEG_TSAP(spn, base_config):
        
    #:param spn: Azure SPN used to call the Databricks REST API
    #:param base_config: BaseConfig object
        
    logging.info("Started data load for BSEG_TSAP from Landing to Raw")

    cost_schema = (StructType([
        StructField("MANDT", StringType(), True),
StructField("BUKRS", StringType(), True),
StructField("BELNR", StringType(), True),
StructField("GJAHR", StringType(), True),
StructField("BUZEI", StringType(), True),
StructField("BUZID", StringType(), True),
StructField("AUGDT", StringType(), True),
StructField("AUGCP", StringType(), True),
StructField("AUGBL", StringType(), True),
StructField("BSCHL", StringType(), True),
StructField("KOART", StringType(), True),
StructField("UMSKZ", StringType(), True),
StructField("UMSKS", StringType(), True),
StructField("ZUMSK", StringType(), True),
StructField("SHKZG", StringType(), True),
StructField("GSBER", StringType(), True),
StructField("PARGB", StringType(), True),
StructField("MWSKZ", StringType(), True),
StructField("QSSKZ", StringType(), True),
StructField("DMBTR", DecimalType(13,2), True),
StructField("WRBTR", DecimalType(13,2), True),
StructField("KZBTR", DecimalType(13,2), True),
StructField("PSWBT", DecimalType(13,2), True),
StructField("PSWSL", StringType(), True),
StructField("TXBHW", DecimalType(13,2), True),
StructField("TXBFW", DecimalType(13,2), True),
StructField("MWSTS", DecimalType(13,2), True),
StructField("WMWST", DecimalType(13,2), True),
StructField("HWBAS", DecimalType(13,2), True),
StructField("FWBAS", DecimalType(13,2), True),
StructField("HWZUZ", DecimalType(13,2), True),
StructField("FWZUZ", DecimalType(13,2), True),
StructField("SHZUZ", StringType(), True),
StructField("STEKZ", StringType(), True),
StructField("MWART", StringType(), True),
StructField("TXGRP", StringType(), True),
StructField("KTOSL", StringType(), True),
StructField("QSSHB", DecimalType(13,2), True),
StructField("KURSR", DecimalType(9,5), True),
StructField("GBETR", DecimalType(13,2), True),
StructField("BDIFF", DecimalType(13,2), True),
StructField("BDIF2", DecimalType(13,2), True),
StructField("VALUT", StringType(), True),
StructField("ZUONR", StringType(), True),
StructField("SGTXT", StringType(), True),
StructField("ZINKZ", StringType(), True),
StructField("VBUND", StringType(), True),
StructField("BEWAR", StringType(), True),
StructField("ALTKT", StringType(), True),
StructField("VORGN", StringType(), True),
StructField("FDLEV", StringType(), True),
StructField("FDGRP", StringType(), True),
StructField("FDWBT", DecimalType(13,2), True),
StructField("FDTAG", StringType(), True),
StructField("FKONT", StringType(), True),
StructField("KOKRS", StringType(), True),
StructField("KOSTL", StringType(), True),
StructField("PROJN", StringType(), True),
StructField("AUFNR", StringType(), True),
StructField("VBELN", StringType(), True),
StructField("VBEL2", StringType(), True),
StructField("POSN2", StringType(), True),
StructField("ETEN2", StringType(), True),
StructField("ANLN1", StringType(), True),
StructField("ANLN2", StringType(), True),
StructField("ANBWA", StringType(), True),
StructField("BZDAT", StringType(), True),
StructField("PERNR", StringType(), True),
StructField("XUMSW", StringType(), True),
StructField("XHRES", StringType(), True),
StructField("XKRES", StringType(), True),
StructField("XOPVW", StringType(), True),
StructField("XCPDD", StringType(), True),
StructField("XSKST", StringType(), True),
StructField("XSAUF", StringType(), True),
StructField("XSPRO", StringType(), True),
StructField("XSERG", StringType(), True),
StructField("XFAKT", StringType(), True),
StructField("XUMAN", StringType(), True),
StructField("XANET", StringType(), True),
StructField("XSKRL", StringType(), True),
StructField("XINVE", StringType(), True),
StructField("XPANZ", StringType(), True),
StructField("XAUTO", StringType(), True),
StructField("XNCOP", StringType(), True),
StructField("XZAHL", StringType(), True),
StructField("SAKNR", StringType(), True),
StructField("HKONT", StringType(), True),
StructField("KUNNR", StringType(), True),
StructField("LIFNR", StringType(), True),
StructField("FILKD", StringType(), True),
StructField("XBILK", StringType(), True),
StructField("GVTYP", StringType(), True),
StructField("HZUON", StringType(), True),
StructField("ZFBDT", StringType(), True),
StructField("ZTERM", StringType(), True),
StructField("ZBD1T", DecimalType(3,0), True),
StructField("ZBD2T", DecimalType(3,0), True),
StructField("ZBD3T", DecimalType(3,0), True),
StructField("ZBD1P", DecimalType(5,3), True),
StructField("ZBD2P", DecimalType(5,3), True),
StructField("SKFBT", DecimalType(13,2), True),
StructField("SKNTO", DecimalType(13,2), True),
StructField("WSKTO", DecimalType(13,2), True),
StructField("ZLSCH", StringType(), True),
StructField("ZLSPR", StringType(), True),
StructField("ZBFIX", StringType(), True),
StructField("HBKID", StringType(), True),
StructField("BVTYP", StringType(), True),
StructField("NEBTR", DecimalType(13,2), True),
StructField("MWSK1", StringType(), True),
StructField("DMBT1", DecimalType(13,2), True),
StructField("WRBT1", DecimalType(13,2), True),
StructField("MWSK2", StringType(), True),
StructField("DMBT2", DecimalType(13,2), True),
StructField("WRBT2", DecimalType(13,2), True),
StructField("MWSK3", StringType(), True),
StructField("DMBT3", DecimalType(13,2), True),
StructField("WRBT3", DecimalType(13,2), True),
StructField("REBZG", StringType(), True),
StructField("REBZJ", StringType(), True),
StructField("REBZZ", StringType(), True),
StructField("REBZT", StringType(), True),
StructField("ZOLLT", StringType(), True),
StructField("ZOLLD", StringType(), True),
StructField("LZBKZ", StringType(), True),
StructField("LANDL", StringType(), True),
StructField("DIEKZ", StringType(), True),
StructField("SAMNR", StringType(), True),
StructField("ABPER", StringType(), True),
StructField("VRSKZ", StringType(), True),
StructField("VRSDT", StringType(), True),
StructField("DISBN", StringType(), True),
StructField("DISBJ", StringType(), True),
StructField("DISBZ", StringType(), True),
StructField("WVERW", StringType(), True),
StructField("ANFBN", StringType(), True),
StructField("ANFBJ", StringType(), True),
StructField("ANFBU", StringType(), True),
StructField("ANFAE", StringType(), True),
StructField("BLNBT", DecimalType(13,2), True),
StructField("BLNKZ", StringType(), True),
StructField("BLNPZ", DecimalType(7,2), True),
StructField("MSCHL", StringType(), True),
StructField("MANSP", StringType(), True),
StructField("MADAT", StringType(), True),
StructField("MANST", StringType(), True),
StructField("MABER", StringType(), True),
StructField("ESRNR", StringType(), True),
StructField("ESRRE", StringType(), True),
StructField("ESRPZ", StringType(), True),
StructField("KLIBT", DecimalType(13,2), True),
StructField("QSZNR", StringType(), True),
StructField("QBSHB", DecimalType(13,2), True),
StructField("QSFBT", DecimalType(13,2), True),
StructField("NAVHW", DecimalType(13,2), True),
StructField("NAVFW", DecimalType(13,2), True),
StructField("MATNR", StringType(), True),
StructField("WERKS", StringType(), True),
StructField("MENGE", DecimalType(13,3), True),
StructField("MEINS", StringType(), True),
StructField("ERFMG", DecimalType(13,3), True),
StructField("ERFME", StringType(), True),
StructField("BPMNG", DecimalType(13,3), True),
StructField("BPRME", StringType(), True),
StructField("EBELN", StringType(), True),
StructField("EBELP", StringType(), True),
StructField("ZEKKN", StringType(), True),
StructField("ELIKZ", StringType(), True),
StructField("VPRSV", StringType(), True),
StructField("PEINH", DecimalType(5,0), True),
StructField("BWKEY", StringType(), True),
StructField("BWTAR", StringType(), True),
StructField("BUSTW", StringType(), True),
StructField("REWRT", DecimalType(13,2), True),
StructField("REWWR", DecimalType(13,2), True),
StructField("BONFB", DecimalType(13,2), True),
StructField("BUALT", DecimalType(13,2), True),
StructField("PSALT", StringType(), True),
StructField("NPREI", DecimalType(11,2), True),
StructField("TBTKZ", StringType(), True),
StructField("SPGRP", StringType(), True),
StructField("SPGRM", StringType(), True),
StructField("SPGRT", StringType(), True),
StructField("SPGRG", StringType(), True),
StructField("SPGRV", StringType(), True),
StructField("SPGRQ", StringType(), True),
StructField("STCEG", StringType(), True),
StructField("EGBLD", StringType(), True),
StructField("EGLLD", StringType(), True),
StructField("RSTGR", StringType(), True),
StructField("RYACQ", StringType(), True),
StructField("RPACQ", StringType(), True),
StructField("RDIFF", DecimalType(13,2), True),
StructField("RDIF2", DecimalType(13,2), True),
StructField("PRCTR", StringType(), True),
StructField("XHKOM", StringType(), True),
StructField("VNAME", StringType(), True),
StructField("RECID", StringType(), True),
StructField("EGRUP", StringType(), True),
StructField("VPTNR", StringType(), True),
StructField("VERTT", StringType(), True),
StructField("VERTN", StringType(), True),
StructField("VBEWA", StringType(), True),
StructField("DEPOT", StringType(), True),
StructField("TXJCD", StringType(), True),
StructField("IMKEY", StringType(), True),
StructField("DABRZ", StringType(), True),
StructField("POPTS", DecimalType(9,6), True),
StructField("FIPOS", StringType(), True),
StructField("KSTRG", StringType(), True),
StructField("NPLNR", StringType(), True),
StructField("AUFPL", StringType(), True),
StructField("APLZL", StringType(), True),
StructField("PROJK", StringType(), True),
StructField("PAOBJNR", StringType(), True),
StructField("PASUBNR", StringType(), True),
StructField("SPGRS", StringType(), True),
StructField("SPGRC", StringType(), True),
StructField("BTYPE", StringType(), True),
StructField("ETYPE", StringType(), True),
StructField("XEGDR", StringType(), True),
StructField("LNRAN", StringType(), True),
StructField("HRKFT", StringType(), True),
StructField("DMBE2", DecimalType(13,2), True),
StructField("DMBE3", DecimalType(13,2), True),
StructField("DMB21", DecimalType(13,2), True),
StructField("DMB22", DecimalType(13,2), True),
StructField("DMB23", DecimalType(13,2), True),
StructField("DMB31", DecimalType(13,2), True),
StructField("DMB32", DecimalType(13,2), True),
StructField("DMB33", DecimalType(13,2), True),
StructField("MWST2", DecimalType(13,2), True),
StructField("MWST3", DecimalType(13,2), True),
StructField("NAVH2", DecimalType(13,2), True),
StructField("NAVH3", DecimalType(13,2), True),
StructField("SKNT2", DecimalType(13,2), True),
StructField("SKNT3", DecimalType(13,2), True),
StructField("BDIF3", DecimalType(13,2), True),
StructField("RDIF3", DecimalType(13,2), True),
StructField("HWMET", StringType(), True),
StructField("GLUPM", StringType(), True),
StructField("XRAGL", StringType(), True),
StructField("UZAWE", StringType(), True),
StructField("LOKKT", StringType(), True),
StructField("FISTL", StringType(), True),
StructField("GEBER", StringType(), True),
StructField("STBUK", StringType(), True),
StructField("TXBH2", DecimalType(13,2), True),
StructField("TXBH3", DecimalType(13,2), True),
StructField("PPRCT", StringType(), True),
StructField("XREF1", StringType(), True),
StructField("XREF2", StringType(), True),
StructField("KBLNR", StringType(), True),
StructField("KBLPOS", StringType(), True),
StructField("STTAX", DecimalType(13,2), True),
StructField("FKBER", StringType(), True),
StructField("OBZEI", StringType(), True),
StructField("XNEGP", StringType(), True),
StructField("RFZEI", StringType(), True),
StructField("CCBTC", StringType(), True),
StructField("KKBER", StringType(), True),
StructField("EMPFB", StringType(), True),
StructField("XREF3", StringType(), True),
StructField("DTWS1", StringType(), True),
StructField("DTWS2", StringType(), True),
StructField("DTWS3", StringType(), True),
StructField("DTWS4", StringType(), True),
StructField("GRICD", StringType(), True),
StructField("GRIRG", StringType(), True),
StructField("GITYP", StringType(), True),
StructField("XPYPR", StringType(), True),
StructField("KIDNO", StringType(), True),
StructField("ABSBT", DecimalType(13,2), True),
StructField("IDXSP", StringType(), True),
StructField("LINFV", StringType(), True),
StructField("KONTT", StringType(), True),
StructField("KONTL", StringType(), True),
StructField("TXDAT", StringType(), True),
StructField("AGZEI", DecimalType(5,0), True),
StructField("PYCUR", StringType(), True),
StructField("PYAMT", DecimalType(13,2), True),
StructField("BUPLA", StringType(), True),
StructField("SECCO", StringType(), True),
StructField("LSTAR", StringType(), True),
StructField("CESSION_KZ", StringType(), True),
StructField("PRZNR", StringType(), True),
StructField("PPDIFF", DecimalType(13,2), True),
StructField("PPDIF2", DecimalType(13,2), True),
StructField("PPDIF3", DecimalType(13,2), True),
StructField("PENLC1", DecimalType(13,2), True),
StructField("PENLC2", DecimalType(13,2), True),
StructField("PENLC3", DecimalType(13,2), True),
StructField("PENFC", DecimalType(13,2), True),
StructField("PENDAYS", IntegerType(), True),
StructField("PENRC", StringType(), True),
StructField("GRANT_NBR", StringType(), True),
StructField("SCTAX", DecimalType(13,2), True),
StructField("FKBER_LONG", StringType(), True),
StructField("GMVKZ", StringType(), True),
StructField("SRTYPE", StringType(), True),
StructField("INTRENO", StringType(), True),
StructField("MEASURE", StringType(), True),
StructField("AUGGJ", StringType(), True),
StructField("PPA_EX_IND", StringType(), True),
StructField("DOCLN", StringType(), True),
StructField("SEGMENT", StringType(), True),
StructField("PSEGMENT", StringType(), True),
StructField("PFKBER", StringType(), True),
StructField("HKTID", StringType(), True),
StructField("KSTAR", StringType(), True),
StructField("XLGCLR", StringType(), True),
StructField("ZZREF4", StringType(), True),
StructField("ZZREF5", StringType(), True),
StructField("ZZREF6", StringType(), True),
StructField("ZZREF7", StringType(), True),
StructField("PEROP_BEG", StringType(), True),
StructField("PEROP_END", StringType(), True),
StructField("FASTPAY", StringType(), True),
StructField("PRODPER", StringType(), True),
StructField("LAST_ACTION_CD", StringType(), True),
StructField("LAST_DTM", DecimalType(15,0), True),
StructField("SYSTEM_ID", StringType(), True),
StructField("ZFINT_LINE_ID", StringType(), True),
StructField("ZFINT_HEADER_ID", StringType(), True),
StructField("ZGL_ACC_ID", StringType(), True),
StructField("ZCOST_CTR_ID", StringType(), True),
StructField("ZCTRL_AREA_ID", StringType(), True),
StructField("ZMEINS_ID", StringType(), True),
StructField("ZVBUND_ID", StringType(), True),
StructField("ZPLANT_ID", StringType(), True),
StructField("ZKTOSL_ID", StringType(), True),
StructField("TAXPS", StringType(), True),

    ])
    )
    dataset_name = "BSEG_TSAP"
    input_format = "parquet"
    partitions = None
    ge_rules = None
    confidentiality=True

    landing_raw(spn, base_config, dataset_name, cost_schema, transform_yrmono, input_format, partitions, ge_rules,confidentiality)
    
    logging.info("Completed data load for BSEG_TSAP from Landing to Raw")

        